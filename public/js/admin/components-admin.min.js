!function(e){function t(e,t,s){return e>t&&t+s>e}e.widget("mjs.nestedSortable",e.extend({},e.ui.sortable.prototype,{options:{doNotClear:!1,expandOnHover:700,isAllowed:function(){return!0},isTree:!1,listType:"ol",maxLevels:0,protectRoot:!1,rootID:null,rtl:!1,startCollapsed:!1,tabSize:20,branchClass:"mjs-nestedSortable-branch",collapsedClass:"mjs-nestedSortable-collapsed",disableNestingClass:"mjs-nestedSortable-no-nesting",errorClass:"mjs-nestedSortable-error",expandedClass:"mjs-nestedSortable-expanded",hoveringClass:"mjs-nestedSortable-hovering",leafClass:"mjs-nestedSortable-leaf"},_create:function(){if(this.element.data("ui-sortable",this.element.data("mjs-nestedSortable")),!this.element.is(this.options.listType))throw new Error("nestedSortable: Please check that the listType option is set to your actual list type");if(this.options.isTree&&this.options.expandOnHover&&(this.options.tolerance="intersect"),e.ui.sortable.prototype._create.apply(this,arguments),this.options.isTree){var t=this;e(this.items).each(function(){var e=this.item;e.children(t.options.listType).length?(e.addClass(t.options.branchClass),e.addClass(t.options.startCollapsed?t.options.collapsedClass:t.options.expandedClass)):e.addClass(t.options.leafClass)})}},_destroy:function(){return this.element.removeData("mjs-nestedSortable").removeData("ui-sortable"),e.ui.sortable.prototype._destroy.apply(this,arguments)},_mouseDrag:function(t){var s,i,o,n,l=this.options,r=!1;this.position=this._generatePosition(t),this.positionAbs=this._convertPositionTo("absolute"),this.lastPositionAbs||(this.lastPositionAbs=this.positionAbs),this.options.scroll&&(this.scrollParent[0]!=document&&"HTML"!=this.scrollParent[0].tagName?(this.overflowOffset.top+this.scrollParent[0].offsetHeight-t.pageY<l.scrollSensitivity?this.scrollParent[0].scrollTop=r=this.scrollParent[0].scrollTop+l.scrollSpeed:t.pageY-this.overflowOffset.top<l.scrollSensitivity&&(this.scrollParent[0].scrollTop=r=this.scrollParent[0].scrollTop-l.scrollSpeed),this.overflowOffset.left+this.scrollParent[0].offsetWidth-t.pageX<l.scrollSensitivity?this.scrollParent[0].scrollLeft=r=this.scrollParent[0].scrollLeft+l.scrollSpeed:t.pageX-this.overflowOffset.left<l.scrollSensitivity&&(this.scrollParent[0].scrollLeft=r=this.scrollParent[0].scrollLeft-l.scrollSpeed)):(t.pageY-e(document).scrollTop()<l.scrollSensitivity?r=e(document).scrollTop(e(document).scrollTop()-l.scrollSpeed):e(window).height()-(t.pageY-e(document).scrollTop())<l.scrollSensitivity&&(r=e(document).scrollTop(e(document).scrollTop()+l.scrollSpeed)),t.pageX-e(document).scrollLeft()<l.scrollSensitivity?r=e(document).scrollLeft(e(document).scrollLeft()-l.scrollSpeed):e(window).width()-(t.pageX-e(document).scrollLeft())<l.scrollSensitivity&&(r=e(document).scrollLeft(e(document).scrollLeft()+l.scrollSpeed))),r!==!1&&e.ui.ddmanager&&!l.dropBehaviour&&e.ui.ddmanager.prepareOffsets(this,t)),this.positionAbs=this._convertPositionTo("absolute");var a=this.placeholder.offset().top;this.options.axis&&"y"===this.options.axis||(this.helper[0].style.left=this.position.left+"px"),this.options.axis&&"x"===this.options.axis||(this.helper[0].style.top=this.position.top+"px"),this.hovering=this.hovering?this.hovering:null,this.mouseentered=this.mouseentered?this.mouseentered:!1;var h=this.placeholder[0].parentNode.parentNode&&e(this.placeholder[0].parentNode.parentNode).closest(".ui-sortable").length?e(this.placeholder[0].parentNode.parentNode):null,c=this._getLevel(this.placeholder),d=this._getChildLevels(this.helper),p=document.createElement(l.listType);for(s=this.items.length-1;s>=0;s--)if(i=this.items[s],o=i.item[0],n=this._intersectsWithPointer(i),n&&i.instance===this.currentContainer&&o!==this.currentItem[0]&&this.placeholder[1===n?"next":"prev"]()[0]!==o&&!e.contains(this.placeholder[0],o)&&("semi-dynamic"===this.options.type?!e.contains(this.element[0],o):!0)){if(this.mouseentered||(e(o).mouseenter(),this.mouseentered=!0),l.isTree&&e(o).hasClass(l.collapsedClass)&&l.expandOnHover&&!this.hovering){e(o).addClass(l.hoveringClass);var u=this;this.hovering=window.setTimeout(function(){e(o).removeClass(l.collapsedClass).addClass(l.expandedClass),u.refreshPositions(),u._trigger("expand",t,u._uiHash())},l.expandOnHover)}if(this.direction=1==n?"down":"up","pointer"!=this.options.tolerance&&!this._intersectsWithSides(i))break;if(e(o).mouseleave(),this.mouseentered=!1,e(o).removeClass(l.hoveringClass),this.hovering&&window.clearTimeout(this.hovering),this.hovering=null,!l.protectRoot||this.currentItem[0].parentNode==this.element[0]&&o.parentNode!=this.element[0])l.protectRoot||this._rearrange(t,i);else if(this.currentItem[0].parentNode!=this.element[0]&&o.parentNode==this.element[0]){e(o).children(l.listType).length||(o.appendChild(p),l.isTree&&e(o).removeClass(l.leafClass).addClass(l.branchClass+" "+l.expandedClass));var f="down"===this.direction?e(o).prev().children(l.listType):e(o).children(l.listType);void 0!==f[0]&&this._rearrange(t,null,f)}else this._rearrange(t,i);this._clearEmpty(o),this._trigger("change",t,this._uiHash());break}var m=this.placeholder[0].previousSibling?e(this.placeholder[0].previousSibling):null;if(null!=m)for(;"li"!=m[0].nodeName.toLowerCase()||m[0]==this.currentItem[0]||m[0]==this.helper[0];){if(!m[0].previousSibling){m=null;break}m=e(m[0].previousSibling)}var g=this.placeholder[0].nextSibling?e(this.placeholder[0].nextSibling):null;if(null!=g)for(;"li"!=g[0].nodeName.toLowerCase()||g[0]==this.currentItem[0]||g[0]==this.helper[0];){if(!g[0].nextSibling){g=null;break}g=e(g[0].nextSibling)}return this.beyondMaxLevels=0,null==h||null!=g||l.protectRoot&&h[0].parentNode==this.element[0]||!(l.rtl&&this.positionAbs.left+this.helper.outerWidth()>h.offset().left+h.outerWidth()||!l.rtl&&this.positionAbs.left<h.offset().left)?null==m||m.hasClass(l.disableNestingClass)||!(m.children(l.listType).length&&m.children(l.listType).is(":visible")||!m.children(l.listType).length)||l.protectRoot&&this.currentItem[0].parentNode==this.element[0]||!(l.rtl&&this.positionAbs.left+this.helper.outerWidth()<m.offset().left+m.outerWidth()-l.tabSize||!l.rtl&&this.positionAbs.left>m.offset().left+l.tabSize)?this._isAllowed(h,c,c+d):(this._isAllowed(m,c,c+d+1),m.children(l.listType).length||(m[0].appendChild(p),l.isTree&&m.removeClass(l.leafClass).addClass(l.branchClass+" "+l.expandedClass)),a&&a<=m.offset().top?m.children(l.listType).prepend(this.placeholder):m.children(l.listType)[0].appendChild(this.placeholder[0]),this._trigger("change",t,this._uiHash())):(h.after(this.placeholder[0]),l.isTree&&h.children(l.listItem).children("li:visible:not(.ui-sortable-helper)").length<1&&h.removeClass(this.options.branchClass+" "+this.options.expandedClass).addClass(this.options.leafClass),this._clearEmpty(h[0]),this._trigger("change",t,this._uiHash())),this._contactContainers(t),e.ui.ddmanager&&e.ui.ddmanager.drag(this,t),this._trigger("sort",t,this._uiHash()),this.lastPositionAbs=this.positionAbs,!1},_mouseStop:function(t){this.beyondMaxLevels&&(this.placeholder.removeClass(this.options.errorClass),this.domPosition.prev?e(this.domPosition.prev).after(this.placeholder):e(this.domPosition.parent).prepend(this.placeholder),this._trigger("revert",t,this._uiHash())),e("."+this.options.hoveringClass).mouseleave().removeClass(this.options.hoveringClass),this.mouseentered=!1,this.hovering&&window.clearTimeout(this.hovering),this.hovering=null,e.ui.sortable.prototype._mouseStop.apply(this,arguments)},_intersectsWithSides:function(e){var s=this.options.isTree?.8:.5,i=t(this.positionAbs.top+this.offset.click.top,e.top+e.height*s,e.height),o=t(this.positionAbs.top+this.offset.click.top,e.top-e.height*s,e.height),n=t(this.positionAbs.left+this.offset.click.left,e.left+e.width/2,e.width),l=this._getDragVerticalDirection(),r=this._getDragHorizontalDirection();return this.floating&&r?"right"==r&&n||"left"==r&&!n:l&&("down"==l&&i||"up"==l&&o)},_contactContainers:function(){this.options.protectRoot&&this.currentItem[0].parentNode==this.element[0]||e.ui.sortable.prototype._contactContainers.apply(this,arguments)},_clear:function(){e.ui.sortable.prototype._clear.apply(this,arguments);for(var t=this.items.length-1;t>=0;t--){var s=this.items[t].item[0];this._clearEmpty(s)}},serialize:function(t){var s=e.extend({},this.options,t),i=this._getItemsAsjQuery(s&&s.connected),o=[];return e(i).each(function(){var t=(e(s.item||this).attr(s.attribute||"id")||"").match(s.expression||/(.+)[-=_](.+)/),i=(e(s.item||this).parent(s.listType).parent(s.items).attr(s.attribute||"id")||"").match(s.expression||/(.+)[-=_](.+)/);t&&o.push((s.key||t[1])+"["+(s.key&&s.expression?t[1]:t[2])+"]="+(i?s.key&&s.expression?i[1]:i[2]:s.rootID))}),!o.length&&s.key&&o.push(s.key+"="),o.join("&")},toHierarchy:function(t){function s(t){var o=(e(t).attr(i.attribute||"id")||"").match(i.expression||/(.+)[-=_](.+)/);if(o){var n={id:o[2]};return e(t).children(i.listType).children(i.items).length>0&&(n.children=[],e(t).children(i.listType).children(i.items).each(function(){var e=s(this);n.children.push(e)})),n}}var i=e.extend({},this.options,t),o=(i.startDepthCount||0,[]);return e(this.element).children(i.items).each(function(){var e=s(this);o.push(e)}),o},toArray:function(t){function s(t,l,r){var a,h,c=r+1;if(e(t).children(i.listType).children(i.items).length>0&&(l++,e(t).children(i.listType).children(i.items).each(function(){c=s(e(this),l,c)}),l--),a=e(t).attr(i.attribute||"id").match(i.expression||/(.+)[-=_](.+)/),l===o+1)h=i.rootID;else{var d=e(t).parent(i.listType).parent(i.items).attr(i.attribute||"id").match(i.expression||/(.+)[-=_](.+)/);h=d[2]}return a&&n.push({item_id:a[2],parent_id:h,depth:l,left:r,right:c}),r=c+1}var i=e.extend({},this.options,t),o=i.startDepthCount||0,n=[],l=1;return i.excludeRoot||(n.push({item_id:i.rootID,parent_id:null,depth:o,left:l,right:2*(e(i.items,this.element).length+1)}),l++),e(this.element).children(i.items).each(function(){l=s(this,o+1,l)}),n=n.sort(function(e,t){return e.left-t.left})},_clearEmpty:function(t){var s=this.options,i=e(t).children(s.listType);!i.length||i.children().length||s.doNotClear?s.isTree&&i.length&&i.children().length&&i.is(":visible")?e(t).removeClass(s.leafClass).addClass(s.branchClass+" "+s.expandedClass):s.isTree&&i.length&&i.children().length&&!i.is(":visible")&&e(t).removeClass(s.leafClass).addClass(s.branchClass+" "+s.collapsedClass):(s.isTree&&e(t).removeClass(s.branchClass+" "+s.expandedClass).addClass(s.leafClass),i.remove())},_getLevel:function(e){var t=1;if(this.options.listType)for(var s=e.closest(this.options.listType);s&&s.length>0&&!s.is(".ui-sortable");)t++,s=s.parent().closest(this.options.listType);return t},_getChildLevels:function(t,s){var i=this,o=this.options,n=0;return s=s||0,e(t).children(o.listType).children(o.items).each(function(e,t){n=Math.max(i._getChildLevels(t,s+1),n)}),s?n+1:n},_isAllowed:function(e,t,s){var i=this.options,o=this.placeholder.closest(".ui-sortable").nestedSortable("option","maxLevels");i.isAllowed(this.placeholder,e,this.currentItem)?s>o&&0!=o?(this.placeholder.addClass(i.errorClass),this.beyondMaxLevels=s-o):(this.placeholder.removeClass(i.errorClass),this.beyondMaxLevels=0):(this.placeholder.addClass(i.errorClass),this.beyondMaxLevels=s>o&&0!=o?s-o:1)}})),e.mjs.nestedSortable.prototype.options=e.extend({},e.ui.sortable.prototype.options,e.mjs.nestedSortable.prototype.options)}(jQuery),function(e){var t={enableAltKey:!0},s={init:function(i){return this.each(function(){i&&e.extend(t,i);var o,n,l,r,a;n={},l=new Date,l.setDate(l.getDate()+365),o=s.readCookie("folderState"),null!==o&&(n=s.objectFromCookie(o)),r=e(this).find("li"),r.each(function(){e(this).hasClass("mjs-nestedSortable-branch")&&"close"===n[e(this).attr("id")]&&e(this).addClass("mjs-nestedSortable-collapsed").removeClass("mjs-nestedSortable-expanded")}),e(".mjs-nestedSortable-branch .disclose").on("click",function(i){a=e(this).closest("li"),a.toggleClass("mjs-nestedSortable-collapsed mjs-nestedSortable-expanded"),a.hasClass("mjs-nestedSortable-collapsed")?(n[a.attr("id")]="close",i.altKey===!0&&t.enableAltKey===!0&&a.find(".mjs-nestedSortable-branch").each(function(){e(this).addClass("mjs-nestedSortable-collapsed").removeClass("mjs-nestedSortable-expanded"),n[e(this).attr("id")]="close"})):(delete n[a.attr("id")],i.altKey===!0&&t.enableAltKey===!0&&a.find(".mjs-nestedSortable-branch").each(function(){e(this).addClass("mjs-nestedSortable-expanded").removeClass("mjs-nestedSortable-collapsed"),delete n[e(this).attr("id")]})),document.cookie="folderState="+s.toSource(n)+"; expires="+l.toUTCString()})})},readCookie:function(e){var t,s,i,o;for(t=e+"=",s=document.cookie.split(";"),i=0;i<s.length;i+=1){for(o=s[i];" "===o.charAt(0);)o=o.substring(1,o.length);if(0===o.indexOf(t))return o.substring(t.length,o.length)}return null},toSource:function(e){var t,s;t=[];for(s in e)e.hasOwnProperty(s)&&t.push(s+":"+e[s]);return t.join(",")},objectFromCookie:function(e){var t,s,i,o;for(t=e.split(","),s={},i=0;i<t.length;i+=1)o=t[i].split(":"),s[o[0]]=o[1];return s}};e.fn.nestedCookie=function(t){return s[t]?s[t].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof t&&t?void e.error("Method "+t+" does not exist on jQuery.nestedCookie"):s.init.apply(this,arguments)}}(jQuery),function(e){var t={slugField:"#slug"},s={init:function(i){return this.each(function(){i&&e.extend(t,i),this.slugField=t.slugField,this.slugGenerateButton=e(this.slugField).parent().find(".btn-slug"),e(this).val()||e(this).keyup(function(){slug=s.convertToSlug(e(this).val()),e(this.slugField).val(slug)}),e(".btn-slug").click(function(){var t=e(this).closest(".form-group").prev().find("input").val(),i=e(this).parent().parent().find("input");return slug=s.convertToSlug(t),i.val(slug),!1})})},convertToSlug:function(t){for(var s=t.replace("œ","oe").replace("?","").replace("æ","ae"),i="ÃÀÁÄÂẼÈÉËÊÌÍÏÎÕÒÓÖÔÙÚÜÛÑÇãàáäâẽèéëêìíïîõòóöôùúüûñç·/_,:;-'’!",o="AAAAAEEEEEIIIIOOOOOUUUUNCaaaaaeeeeeiiiiooooouuuunc          ",n=0,l=i.length;l>n;n++)s=s.replace(new RegExp(i.charAt(n),"g"),o.charAt(n));return s=e.trim(s),s=s.toLowerCase().replace(/[^\w ]+/g,"").replace(/ +/g,"-")}};e.fn.slug=function(t){return s[t]?s[t].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof t&&t?void e.error("Method "+t+" does not exist on jQuery.slug"):s.init.apply(this,arguments)}}(jQuery),function(e){var t,s,i,o,n,l,r,a={done:function(){},error:function(){}},h={nl:{"delete":"Supprimer",Cancel:"Annuler",item:"élément"},en:{"delete":"Delete",Cancel:"Cancel",item:"item"},fr:{"delete":"Supprimer",Cancel:"Annuler",item:"élément"}},c=e("html").attr("lang"),d={init:function(s){return this.each(function(){s&&e.extend(a,s),t=e(this),e(":submit").addClass("custom-alert"),e(":submit").click(function(){o=this.name}),t.submit(d.beforeSubmit),t.find(".btn-toolbar button").prop("disabled",!0),t.find(".btn-toolbar").prepend('<div class="btn-group" id="selectAllGroup"></div>'),n=e("#btn-select-all"),l=n.text(),r=n.data("deselect-text"),n.click(function(){e(this).toggleClass("checked");var s;return e(this).hasClass("checked")&&(s="checked"),t.find("input:checkbox:not(:disabled)").each(function(){this.checked=s,n.text(s?r:l)}),d.verifierCheckboxes(),!1}),t.find(":checkbox").change(function(){this.checked?d.checkChilds(e(this)):d.uncheckParents(e(this)),d.verifierCheckboxes()})})},beforeSubmit:function(){var t;if(i>0){if("delete"!==o)return!0;t=d.translate(o)+" "+i.toString()+" "+d.translate("item"),i>1&&(t+="s"),t+=" ?",bootbox.dialog(t,[{label:d.translate("Cancel")},{label:d.translate(o),"class":"btn-danger",callback:d.launchAction}],{header:"Attention",animate:!1,onEscape:function(){e(this).close()}})}return!1},launchAction:function(){t.find(".btn-toolbar button").prop("disabled",!0);t.find("input:checkbox:checked").parent();if("delete"===o){var s=t.find("#nb_elements");s.html()>"0"&&s.html(s.html()-parseInt(i,10))}e.ajax({type:"POST",url:t.attr("action"),dataType:"json",data:t.serialize()+"&"+o+"="+o,success:function(e){a.done.call(this,e)},error:function(e,t,s){a.error.call(this,e,t,s)}})},translate:function(e){return h[c][e]},verifierCheckboxes:function(){s=t.find("input:checkbox:not(:disabled)").length,i=t.find("input:checkbox:checked").length,0===i?(t.find(".btn-toolbar button").prop("disabled",!0),n.text(l).removeClass("checked").prop({checked:!1})):(t.find(".btn-toolbar button").prop("disabled",!1),s===i?n.text(r).addClass("checked").prop({checked:!0}):n.text(l).removeClass("checked").prop({checked:!1}))},checkChilds:function(e){e.closest("li").find("input:checkbox").prop({checked:"checked"})},uncheckParents:function(e){e.parents("li").children().children("input:checkbox").prop({checked:""})}};e.fn.listEnhancer=function(t){return d[t]?d[t].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof t&&t?void e.error("Method "+t+" does not exist on jQuery.listEnhancer"):d.init.apply(this,arguments)}}(jQuery);